---
source: compiler-core/src/javascript/tests/case_clause_guards.rs
expression: "pub fn main(xs, y) {\n  case xs {\n    #(x) if xs == y -> x\n    _ -> 0\n  }\n}\n"

---
export function main(xs, y) {
  if ($equal(xs, y)) {
    let x = xs[0];
    return x;
  } else {
    return 0;
  }
}

function $equal(x, y) {
  let values = [x, y];
  while (values.length !== 0) {
    let a = values.pop();
    let b = values.pop();
    if (
      a === b ||
      (a instanceof Uint8Array &&
        b instanceof Uint8Array &&
        a.byteLength === b.byteLength &&
        a.every((x, i) => x === b[i]))
    )
      continue;
    if (!$is_object(a) || !$is_object(b) || a.length !== b.length) return false;
    for (let k of Object.keys(a)) values.push(a[k], b[k]);
  }
  return true;
}

function $is_object(object) {
  return object !== null && typeof object === 'object';
}

